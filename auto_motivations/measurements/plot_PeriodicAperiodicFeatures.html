<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Conflating Periodic &amp; Aperiodic Changes &#8212; fooof 1.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172157729-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172157729-1');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          fooof</a>
        <span class="navbar-text navbar-version pull-left"><b>1.1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../index.html">Motivations</a></li>
                <li><a href="../../auto_tutorials/index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../visualizers.html">Visualizers</a></li>
                <li><a href="../../reference.html">Reference</a></li>
                <li><a href="https://github.com/fooof-tools/fooof">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-motivations-measurements-plot-periodicaperiodicfeatures-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="conflating-periodic-aperiodic-changes">
<span id="sphx-glr-auto-motivations-measurements-plot-periodicaperiodicfeatures-py"></span><h1>Conflating Periodic &amp; Aperiodic Changes<a class="headerlink" href="#conflating-periodic-aperiodic-changes" title="Permalink to this heading">¶</a></h1>
<p>Demonstrating how changes in periodic &amp; aperiodic parameters can be conflated.</p>
<p>This example is a code implementation and quantitatively exact version of Figure 1 from the
<a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.01.11.900977v1">Parameterizing Neural Power Spectra</a>
paper.</p>
<section id="measuring-neural-activity">
<h2>Measuring Neural Activity<a class="headerlink" href="#measuring-neural-activity" title="Permalink to this heading">¶</a></h2>
<p>In electrophysiological data analysis, we often wish to measure and interpret changes
in particular aspects of our data, for example, measuring changes in the power of
a frequency band of interest.</p>
<p>In this example, we will examine how using predefined frequency ranges to measure
and then interpret differences from power spectra can lead to misinterpretations
in the face of complex data in which multiple different aspects of the data can
change or vary within and between recordings.</p>
<p>We conceptualize neural data as complex data that contains multiple ‘components’, which
we categorize as periodic and aperiodic, and note that each of these components can also
have multiple parameters, each of which could vary.</p>
<p>To briefly recap, these components and parameters include:</p>
<ul class="simple">
<li><p>aperiodic activity, the 1/f-like aspect of the data, described, at minimum with:</p>
<ul>
<li><p>exponent</p></li>
<li><p>offset</p></li>
</ul>
</li>
<li><p>periodic activity, peaks in the power spectrum, each with a:</p>
<ul>
<li><p>center frequency</p></li>
<li><p>power</p></li>
<li><p>bandwidth</p></li>
</ul>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy &amp; matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Import simulation, utility, and plotting tools</span>
<span class="kn">from</span> <span class="nn">fooof.bands</span> <span class="kn">import</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">Bands</span></a>
<span class="kn">from</span> <span class="nn">fooof.utils</span> <span class="kn">import</span> <a href="../../generated/fooof.utils.trim_spectrum.html#fooof.utils.trim_spectrum" title="fooof.utils.trim_spectrum" class="sphx-glr-backref-module-fooof-utils sphx-glr-backref-type-py-function"><span class="n">trim_spectrum</span></a>
<span class="kn">from</span> <span class="nn">fooof.sim.gen</span> <span class="kn">import</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a>
<span class="kn">from</span> <span class="nn">fooof.plts.spectra</span> <span class="kn">import</span> <a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Settings for plotting</span>
<span class="n">log_freqs</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">log_powers</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">shade_color</span> <span class="o">=</span> <span class="s1">&#39;#0365C0&#39;</span>
</pre></div>
</div>
<section id="simulating-data">
<h3>Simulating Data<a class="headerlink" href="#simulating-data" title="Permalink to this heading">¶</a></h3>
<p>For this example, we will use simulated data, and consider the example case of
investigating differences in alpha activity.</p>
<p>We will start by simulating a baseline power spectrum, with an alpha peak, and
concurrent aperiodic activity. We will also simulate several altered versions of
this spectrum, each which a change in a specific parameter of the power spectrum.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define our bands of interest</span>
<a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a> <span class="o">=</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">Bands</span></a><span class="p">({</span><span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">)})</span>

<span class="c1"># Simulation Settings</span>
<span class="n">nlv</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">f_res</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">f_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">]</span>

<span class="c1"># Define baseline parameter values</span>
<span class="n">ap_base</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="n">pe_base</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="c1"># Define parameters sets with changes in each parameter</span>
<span class="n">pw_diff</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.311</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">cf_diff</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">11.75</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">off_diff</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.126</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="n">exp_diff</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.87</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create baseline power spectrum, to compare to</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">powers_base</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">ap_base</span><span class="p">,</span> <span class="n">pe_base</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create comparison power spectra, with differences in different parameters of the data</span>
<span class="n">_</span><span class="p">,</span> <span class="n">powers_pw</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">ap_base</span><span class="p">,</span> <span class="n">pw_diff</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">powers_cf</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">ap_base</span><span class="p">,</span> <span class="n">cf_diff</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">powers_off</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">off_diff</span><span class="p">,</span> <span class="n">pe_base</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">powers_exp</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">exp_diff</span><span class="p">,</span> <span class="n">pe_base</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Collect the comparison power spectra together</span>
<span class="n">all_powers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Alpha Power Change&#39;</span> <span class="p">:</span> <span class="n">powers_pw</span><span class="p">,</span>
    <span class="s1">&#39;Alpha Frequency Change&#39;</span> <span class="p">:</span> <span class="n">powers_cf</span><span class="p">,</span>
    <span class="s1">&#39;Offset Change&#39;</span> <span class="p">:</span> <span class="n">powers_off</span><span class="p">,</span>
    <span class="s1">&#39;Exponent Change&#39;</span> <span class="p">:</span> <span class="n">powers_exp</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="plotting-power-spectra">
<h3>Plotting Power Spectra<a class="headerlink" href="#plotting-power-spectra" title="Permalink to this heading">¶</a></h3>
<p>Now that we have our power spectra simulated, let’s plot them all together.</p>
<p>In the visualization below, we can see that we have created four sets of comparisons,
where each has a change in one parameter of the data.</p>
<p>Specifically, these changes are:</p>
<ul class="simple">
<li><p>a change in alpha <strong>power</strong>, part of the periodic component</p></li>
<li><p>a change in alpha <strong>center frequency</strong>, part of the periodic component</p></li>
<li><p>a change in the <strong>offset</strong> of the aperiodic component</p></li>
<li><p>a change in the <strong>exponent</strong> of the aperiodic component</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot and compare all of our power spectra</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">powers</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">all_powers</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

    <span class="c1"># Create spectrum plot, with alpha band of interest shaded in</span>
    <a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><span class="n">powers_base</span><span class="p">,</span> <span class="n">powers</span><span class="p">],</span>
                         <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">shade_colors</span><span class="o">=</span><span class="n">shade_color</span><span class="p">,</span>
                         <span class="n">log_freqs</span><span class="o">=</span><span class="n">log_freqs</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="n">log_powers</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Add the title, and do some plot styling</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fontsize&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_PeriodicAperiodicFeatures_001.png" srcset="../../_images/sphx_glr_plot_PeriodicAperiodicFeatures_001.png" alt="Alpha Power Change, Alpha Frequency Change, Offset Change, Exponent Change" class = "sphx-glr-single-img"/></section>
<section id="comparing-power-spectra">
<h3>Comparing Power Spectra<a class="headerlink" href="#comparing-power-spectra" title="Permalink to this heading">¶</a></h3>
<p>Now let’s compare our different power spectra, in terms of band-specific power measures.</p>
<p>To do so, we will first define a helper function that calculates the average power in
a band.</p>
<p>Then, for each pair, consisting of the baseline power spectrum and an adapted version
in which one parameter has been changed, we can measure the change in band specific
activity relating to this change.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calc_avg_power</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">freq_range</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function to calculate average power in a band.&quot;&quot;&quot;</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">band_powers</span> <span class="o">=</span> <a href="../../generated/fooof.utils.trim_spectrum.html#fooof.utils.trim_spectrum" title="fooof.utils.trim_spectrum" class="sphx-glr-backref-module-fooof-utils sphx-glr-backref-type-py-function"><span class="n">trim_spectrum</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="n">freq_range</span><span class="p">)</span>
    <span class="n">avg_power</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">band_powers</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">avg_power</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the amount of alpha power in the baseline power spectrum</span>
<span class="n">base_alpha</span> <span class="o">=</span> <span class="n">calc_avg_power</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers_base</span><span class="p">,</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the different in alpha power for each of our comparison pairs</span>
<span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">powers</span> <span class="ow">in</span> <span class="n">all_powers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20s}</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
        <span class="n">title</span><span class="p">,</span> <span class="n">calc_avg_power</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">.</span><span class="n">alpha</span><span class="p">)</span> <span class="o">-</span> <span class="n">base_alpha</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Alpha Power Change       -0.0171
Alpha Frequency Change   -0.0171
Offset Change            -0.0171
Exponent Change          -0.0171
</pre></div>
</div>
<p>We can see that all of these cases have the exact measured change in alpha power!</p>
<p>However, given that we know exactly what was changed in the simulated data, we know
that a change in alpha power is only the correct interpretation in one of the cases
that we simulated.</p>
<p>For all the other comparisons, the change in the data is not a change in band specific
power. Despite this, the common analysis approach measures it as such.</p>
<p>This shows how measurements that are supposed to reflect band specific power changes
can easily be conflated and misinterpreted, as they can be driven by other changes
in the data.</p>
</section>
<section id="spectra-without-any-oscillations">
<h3>Spectra Without any Oscillations<a class="headerlink" href="#spectra-without-any-oscillations" title="Permalink to this heading">¶</a></h3>
<p>So far we have considered the case in which the goal is to analyze and measure
alpha power activity, in a scenario in which there actually is alpha activity.</p>
<p>However, we can also consider the possible scenario of analyzing alpha power (or, by
analogy, any other band), in cases in which there is no band-specific power.</p>
<p>To do so, we will simulate, plot and measure a new set of data, with the same set up
as above, but without adding any alpha peaks to the spectra.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Redefine baseline with no alpha</span>
<span class="n">pe_base_na</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">22</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>

<span class="c1"># Redefine changes in for each parameter</span>
<span class="n">off_diff_na</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.321</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="n">exp_diff_na</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.31</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create baseline power spectrum, to compare to</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">powers_noa_base</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">ap_base</span><span class="p">,</span> <span class="n">pe_base_na</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)</span>

<span class="c1"># Collect all powers together,</span>
<span class="n">all_powers_na</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Offset Change&#39;</span> <span class="p">:</span> \
                    <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">off_diff_na</span><span class="p">,</span> <span class="n">pe_base_na</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span>
                 <span class="s1">&#39;Exponent Change&#39;</span> <span class="p">:</span> \
                    <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">exp_diff_na</span><span class="p">,</span> <span class="n">pe_base_na</span><span class="p">,</span> <span class="n">nlv</span><span class="p">,</span> <span class="n">f_res</span><span class="p">)[</span><span class="mi">1</span><span class="p">]}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot and compare spectra with no alpha</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">powers</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">all_powers_na</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>

    <span class="c1"># Create spectrum plot, with alpha band of interest shaded in</span>
    <a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><span class="n">powers_noa_base</span><span class="p">,</span> <span class="n">powers</span><span class="p">],</span>
                         <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">shade_colors</span><span class="o">=</span><span class="n">shade_color</span><span class="p">,</span>
                         <span class="n">log_freqs</span><span class="o">=</span><span class="n">log_freqs</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="n">log_powers</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Add the title, and do some plot styling</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;fontsize&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_PeriodicAperiodicFeatures_002.png" srcset="../../_images/sphx_glr_plot_PeriodicAperiodicFeatures_002.png" alt="Offset Change, Exponent Change" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate and compare the difference of &#39;alpha&#39; power</span>
<span class="n">base_noa_power</span> <span class="o">=</span> <span class="n">calc_avg_power</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers_noa_base</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="k">for</span> <span class="n">title</span><span class="p">,</span> <span class="n">powers</span> <span class="ow">in</span> <span class="n">all_powers_na</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:20s}</span><span class="se">\t</span><span class="s1"> </span><span class="si">{:1.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>\
        <span class="n">title</span><span class="p">,</span> <span class="n">calc_avg_power</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">powers</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span> <span class="o">-</span> <span class="n">base_noa_power</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Offset Change            -0.0171
Exponent Change          -0.0171
</pre></div>
</div>
<p>In the plots and analyses above, we can see that when analyzing a predefined narrow-band
frequency range, we can get the same measured difference in ‘alpha’ power between
spectra, even if there is no evidence of an oscillation at all.</p>
</section>
<section id="conclusion">
<h3>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h3>
<p>In the simulations above, we have shown that changes in multiple different parameters can
lead to the same measured difference in band-specific power.</p>
<p>In any given case in which narrow-band ranges are used, any of these changes, or
a combination of them, could be contributing to the measured changes.</p>
<p>As an alternative to analyzing narrow-band power, parameterizing power spectra offers
an approach that can measure which parameters of the data are changing, and in what
ways.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.825 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-motivations-measurements-plot-periodicaperiodicfeatures-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/112729f849787b38e89f77cf269985c0/plot_PeriodicAperiodicFeatures.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_PeriodicAperiodicFeatures.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e4ef6df4590ca63466dc3b85c671a8f6/plot_PeriodicAperiodicFeatures.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_PeriodicAperiodicFeatures.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2023, VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>