<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Band-by-Band &#8212; fooof 1.0.0 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172157729-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172157729-1');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          fooof</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../api.html">API</a></li>
                <li><a href="../../faq.html">FAQ</a></li>
                <li><a href="../../glossary.html">Glossary</a></li>
                <li><a href="../index.html">Motivations</a></li>
                <li><a href="../../auto_tutorials/index.html">Tutorials</a></li>
                <li><a href="../../auto_examples/index.html">Examples</a></li>
                <li><a href="../../reference.html">Reference</a></li>
                <li><a href="https://github.com/fooof-tools/fooof">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-motivations-measurements-plot-bandbyband-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="band-by-band">
<span id="sphx-glr-auto-motivations-measurements-plot-bandbyband-py"></span><h1>Band-by-Band<a class="headerlink" href="#band-by-band" title="Permalink to this headline">¶</a></h1>
<p>Comparing how ‘Band-by-Band’ approaches relate to periodic &amp; aperiodic components.</p>
<p>This example is based on a recent project investigating band-by-band analyses as
often done in the context of development. The paper for that project is available
<a class="reference external" href="https://doi.org/10.1101/839258">here</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numpy and matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Import the FOOOF object</span>
<span class="kn">from</span> <span class="nn">fooof</span> <span class="kn">import</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a>

<span class="c1"># Import simulation, utility, and plotting tools</span>
<span class="kn">from</span> <span class="nn">fooof.bands</span> <span class="kn">import</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">Bands</span></a>
<span class="kn">from</span> <span class="nn">fooof.utils</span> <span class="kn">import</span> <a href="../../generated/fooof.utils.trim_spectrum.html#fooof.utils.trim_spectrum" title="fooof.utils.trim_spectrum" class="sphx-glr-backref-module-fooof-utils sphx-glr-backref-type-py-function"><span class="n">trim_spectrum</span></a>
<span class="kn">from</span> <span class="nn">fooof.analysis</span> <span class="kn">import</span> <a href="../../generated/fooof.analysis.get_band_peak_fm.html#fooof.analysis.get_band_peak_fm" title="fooof.analysis.get_band_peak_fm" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fm</span></a>
<span class="kn">from</span> <span class="nn">fooof.sim.gen</span> <span class="kn">import</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a>
<span class="kn">from</span> <span class="nn">fooof.sim.utils</span> <span class="kn">import</span> <a href="../../generated/fooof.sim.utils.set_random_seed.html#fooof.sim.utils.set_random_seed" title="fooof.sim.utils.set_random_seed" class="sphx-glr-backref-module-fooof-sim-utils sphx-glr-backref-type-py-function"><span class="n">set_random_seed</span></a>
<span class="kn">from</span> <span class="nn">fooof.plts.spectra</span> <span class="kn">import</span> <a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a>
</pre></div>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A common analysis approach for investigating neural data is to measure and analyze
changes across multiple frequency bands.</p>
<p>This is typically done using predefined bands, such as:</p>
<ul class="simple">
<li><p>delta (1-4 Hz)</p></li>
<li><p>theta (4-8 Hz)</p></li>
<li><p>alpha (8-13 Hz)</p></li>
<li><p>beta (13-30 Hz)</p></li>
<li><p>gamma (30-50 Hz)</p></li>
</ul>
<p>When analyzed in this way, and comparing within or between subjects, investigations often
report a pattern of changes or differences across bands, for example:</p>
<ul class="simple">
<li><p>decreased power in lower frequency bands (delta, theta)</p></li>
<li><p>increased power in higher frequency bands (beta, gamma)</p></li>
</ul>
<p>Under this framework, each defined band reflects a different entity in the data,
and the interpretation is typically that there are multiple things changing, with
correlated changes in power across multiple distinct bands.</p>
<p>An alternative hypothesis for what is changing is that this pattern of results could
be driven by changes or differences in the aperiodic component of the data. Changes
in aperiodic activity, when analyzed in a band-by-band manner, can look like correlated
changes across multiple bands.</p>
<p>In this example, we will use simulated data to examine both the different ways of
analyzing such data (band-by-band compared to parameterizing neural power spectra),
and examine what it looks like if data differs in these hypothesized ways.
To do so, we will simulate and analyze data with correlated changes in multiple
distinct frequency bands, as well as data in which there is a shift in the aperiodic
component.</p>
<div class="section" id="settings">
<h3>Settings<a class="headerlink" href="#settings" title="Permalink to this headline">¶</a></h3>
<p>First, we can define some settings for this notebook and analysis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define our frequency bands of interest</span>
<a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a> <span class="o">=</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">Bands</span></a><span class="p">({</span><span class="s1">&#39;delta&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
               <span class="s1">&#39;theta&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
               <span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
               <span class="s1">&#39;beta&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
               <span class="s1">&#39;gamma&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">]})</span>

<span class="c1"># Define plot settings</span>
<span class="n">t_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fontsize&#39;</span> <span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;fontweight&#39;</span> <span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">}</span>
<span class="n">shade_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#e8dc35&#39;</span><span class="p">,</span> <span class="s1">&#39;#46b870&#39;</span><span class="p">,</span> <span class="s1">&#39;#1882d9&#39;</span><span class="p">,</span> <span class="s1">&#39;#a218d9&#39;</span><span class="p">,</span> <span class="s1">&#39;#e60026&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Group-1&#39;</span><span class="p">,</span> <span class="s1">&#39;Group-2&#39;</span><span class="p">]</span>

<span class="c1"># General simulation settings</span>
<span class="n">f_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">nlv</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Define some template strings for reporting</span>
<span class="n">exp_template</span> <span class="o">=</span> <span class="s2">&quot;The difference of aperiodic exponent is: </span><span class="se">\t</span><span class="s2"> </span><span class="si">{:1.2f}</span><span class="s2">&quot;</span>
<span class="n">pw_template</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The difference of </span><span class="si">{:5}</span><span class="s2"> power is  </span><span class="si">{: 1.2f}</span><span class="se">\t</span><span class="s2">&quot;</span>
               <span class="s2">&quot;with peaks or  </span><span class="si">{: 1.2f}</span><span class="se">\t</span><span class="s2"> with bands.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="helper-functions">
<h3>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h3>
<p>Throughout this notebook we will be computing and analyzing differences between
power spectra. Here, we will define some helper functions to do so.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compare_exp</span><span class="p">(</span><span class="n">fm1</span><span class="p">,</span> <span class="n">fm2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compare exponent values.&quot;&quot;&quot;</span>

    <span class="n">exp1</span> <span class="o">=</span> <span class="n">fm1</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="s1">&#39;aperiodic_params&#39;</span><span class="p">,</span> <span class="s1">&#39;exponent&#39;</span><span class="p">)</span>
    <span class="n">exp2</span> <span class="o">=</span> <span class="n">fm2</span><span class="o">.</span><span class="n">get_params</span><span class="p">(</span><span class="s1">&#39;aperiodic_params&#39;</span><span class="p">,</span> <span class="s1">&#39;exponent&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">exp1</span> <span class="o">-</span> <span class="n">exp2</span>

<span class="k">def</span> <span class="nf">compare_peak_pw</span><span class="p">(</span><span class="n">fm1</span><span class="p">,</span> <span class="n">fm2</span><span class="p">,</span> <span class="n">band_def</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compare the power of detected peaks.&quot;&quot;&quot;</span>

    <span class="n">pw1</span> <span class="o">=</span> <a href="../../generated/fooof.analysis.get_band_peak_fm.html#fooof.analysis.get_band_peak_fm" title="fooof.analysis.get_band_peak_fm" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fm</span></a><span class="p">(</span><span class="n">fm1</span><span class="p">,</span> <span class="n">band_def</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">pw2</span> <span class="o">=</span> <a href="../../generated/fooof.analysis.get_band_peak_fm.html#fooof.analysis.get_band_peak_fm" title="fooof.analysis.get_band_peak_fm" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fm</span></a><span class="p">(</span><span class="n">fm2</span><span class="p">,</span> <span class="n">band_def</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">pw1</span> <span class="o">-</span> <span class="n">pw2</span>

<span class="k">def</span> <span class="nf">compare_band_pw</span><span class="p">(</span><span class="n">fm1</span><span class="p">,</span> <span class="n">fm2</span><span class="p">,</span> <span class="n">band_def</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compare the power of frequency band ranges.&quot;&quot;&quot;</span>

    <span class="n">pw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><a href="../../generated/fooof.utils.trim_spectrum.html#fooof.utils.trim_spectrum" title="fooof.utils.trim_spectrum" class="sphx-glr-backref-module-fooof-utils sphx-glr-backref-type-py-function"><span class="n">trim_spectrum</span></a><span class="p">(</span><span class="n">fm1</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="n">fm1</span><span class="o">.</span><span class="n">power_spectrum</span><span class="p">,</span> <span class="n">band_def</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">pw2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><a href="../../generated/fooof.utils.trim_spectrum.html#fooof.utils.trim_spectrum" title="fooof.utils.trim_spectrum" class="sphx-glr-backref-module-fooof-utils sphx-glr-backref-type-py-function"><span class="n">trim_spectrum</span></a><span class="p">(</span><span class="n">fm1</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="n">fm2</span><span class="o">.</span><span class="n">power_spectrum</span><span class="p">,</span> <span class="n">band_def</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">pw1</span> <span class="o">-</span> <span class="n">pw2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Band-by-Band<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>In the ‘band-by-band’ idea of the data, analyses and interpretations focus on analyzing
activity across a range of frequency bands, and looking for patterns of changes within
and between these bands.</p>
<p>To visualize this, we can simulate hypothesized power spectra for different groups,
in which we will set the same aperiodic activity, and vary overlying periodic peaks.</p>
<p>In this example, for clarity, the center frequencies for all peaks are
simulated as being the same between groups, though in real data these could also vary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set consistent aperiodic parameters</span>
<span class="n">ap_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># Set periodic parameters, defined to vary between groups</span>
<span class="c1">#   All parameters are set to match, except for systematic power differences</span>
<span class="n">pe_g1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]]</span>
<span class="n">pe_g2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">]]</span>

<span class="c1"># Set random seed, for consistency generating simulated data</span>
<a href="../../generated/fooof.sim.utils.set_random_seed.html#fooof.sim.utils.set_random_seed" title="fooof.sim.utils.set_random_seed" class="sphx-glr-backref-module-fooof-sim-utils sphx-glr-backref-type-py-function"><span class="n">set_random_seed</span></a><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate example power spectra for each group</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">g1_spectrum_bands</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">ap_params</span><span class="p">,</span> <span class="n">pe_g1</span><span class="p">,</span> <span class="n">nlv</span><span class="p">)</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">g2_spectrum_bands</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="n">ap_params</span><span class="p">,</span> <span class="n">pe_g2</span><span class="p">,</span> <span class="n">nlv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the power spectra differences, representing the &#39;band-by-band&#39; idea</span>
<a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><span class="n">g1_spectrum_bands</span><span class="p">,</span> <span class="n">g2_spectrum_bands</span><span class="p">],</span>
                     <span class="n">log_powers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">shades</span><span class="o">=</span><a href="../../generated/fooof.Bands.html#fooof.Bands.definitions" title="fooof.Bands.definitions" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">bands</span><span class="o">.</span><span class="n">definitions</span></a><span class="p">,</span> <span class="n">shade_colors</span><span class="o">=</span><span class="n">shade_cols</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">f_range</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Band-by-Band&#39;</span><span class="p">,</span> <span class="n">t_settings</span><span class="p">);</span>
</pre></div>
</div>
<img alt="Band-by-Band" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_BandByBand_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Band-by-Band&#39;)
</pre></div>
</div>
<div class="section" id="flatten-the-spectra">
<h3>Flatten the Spectra<a class="headerlink" href="#flatten-the-spectra" title="Permalink to this headline">¶</a></h3>
<p>Under the band-by-band idea, controlling for aperiodic activity and flattening
the spectra should show specific differences in each band.</p>
<p>It should also find no systematic difference in the aperiodic activity between groups.</p>
<p>To check this, we can fit power spectrum models, and examine which parameters are
changing in the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize FOOOF objects</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g1</span></a> <span class="o">=</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g2</span></a> <span class="o">=</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Fit power spectrum models</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF.fit" title="fooof.FOOOF.fit" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fm_bands_g1</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">g1_spectrum_bands</span><span class="p">)</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF.fit" title="fooof.FOOOF.fit" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fm_bands_g2</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">g2_spectrum_bands</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the power spectra differences</span>
<a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g1</span></a><span class="o">.</span><span class="n">_spectrum_flat</span><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g2</span></a><span class="o">.</span><span class="n">_spectrum_flat</span><span class="p">],</span>
                     <span class="n">log_powers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">shades</span><span class="o">=</span><a href="../../generated/fooof.Bands.html#fooof.Bands.definitions" title="fooof.Bands.definitions" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">bands</span><span class="o">.</span><span class="n">definitions</span></a><span class="p">,</span> <span class="n">shade_colors</span><span class="o">=</span><span class="n">shade_cols</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">f_range</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Band-by-Band - Flattened&#39;</span><span class="p">,</span> <span class="n">t_settings</span><span class="p">);</span>
</pre></div>
</div>
<img alt="Band-by-Band - Flattened" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_BandByBand_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Band-by-Band - Flattened&#39;)
</pre></div>
</div>
</div>
<div class="section" id="compare-spectral-parameters">
<h3>Compare Spectral Parameters<a class="headerlink" href="#compare-spectral-parameters" title="Permalink to this headline">¶</a></h3>
<p>Next, let’s compare the measured parameters of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the difference of aperiodic activity between age groups</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compare_exp</span><span class="p">(</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g1</span></a><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g2</span></a><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The difference of aperiodic exponent is:         -0.07
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the difference in periodic activity, across bands, between groups</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">definition</span> <span class="ow">in</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pw_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">compare_peak_pw</span><span class="p">(</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g1</span></a><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g2</span></a><span class="p">,</span> <span class="n">definition</span><span class="p">),</span>
                             <span class="n">compare_band_pw</span><span class="p">(</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g1</span></a><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_bands_g2</span></a><span class="p">,</span> <span class="n">definition</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The difference of delta power is  -0.18 with peaks or  -0.16     with bands.
The difference of theta power is  -0.05 with peaks or  -0.06     with bands.
The difference of alpha power is   0.02 with peaks or  -0.00     with bands.
The difference of beta  power is   0.05 with peaks or   0.02     with bands.
The difference of gamma power is   0.08 with peaks or   0.04     with bands.
</pre></div>
</div>
<p>In the measurements above, we can see there is a negligible difference in the aperiodic
properties of the data, but that there are differences within individual bands, with
the same pattern of results highlighted by comparing either the parameterized peaks
or the average band power.</p>
<p>This is as expected, given that we simulated the data to reflect this idea. In the
simulation we can see that both a band-by-band analysis, and parameterizing neural
power spectra give the same, and correct result for this case.</p>
</div>
</div>
<div class="section" id="periodic-aperiodic">
<h2>Periodic &amp; Aperiodic<a class="headerlink" href="#periodic-aperiodic" title="Permalink to this headline">¶</a></h2>
<p>An alternative hypothesis is that aperiodic activity may vary between groups.</p>
<p>In the next simulation, we will simulate each group as having same periodic activity,
in this case, just an alpha peak, with a difference in the aperiodic activity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate spectra for each group, with aperiodic differences</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">g1_spectrum_pa</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">nlv</span><span class="p">)</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">g2_spectrum_pa</span> <span class="o">=</span> <a href="../../generated/fooof.sim.gen_power_spectrum.html#fooof.sim.gen_power_spectrum" title="fooof.sim.gen_power_spectrum" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_power_spectrum</span></a><span class="p">(</span><span class="n">f_range</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">nlv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the power spectra differences</span>
<a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><span class="n">g1_spectrum_pa</span><span class="p">,</span> <span class="n">g2_spectrum_pa</span><span class="p">],</span>
                     <span class="n">log_freqs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_powers</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">shades</span><span class="o">=</span><a href="../../generated/fooof.Bands.html#fooof.Bands.definitions" title="fooof.Bands.definitions" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">bands</span><span class="o">.</span><span class="n">definitions</span></a><span class="p">,</span> <span class="n">shade_colors</span><span class="o">=</span><span class="n">shade_cols</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">f_range</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Periodic &amp; Aperiodic&#39;</span><span class="p">,</span> <span class="n">t_settings</span><span class="p">);</span>
</pre></div>
</div>
<img alt="Periodic &amp; Aperiodic" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_BandByBand_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Periodic &amp; Aperiodic&#39;)
</pre></div>
</div>
<div class="section" id="id2">
<h3>Flatten the Spectra<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>In the scenario in which there are differences in aperiodic activity, flattening
the spectra should show no differences in periodic peaks.</p>
<p>We can again parameterize the spectra to investigate this.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize FOOOF objects</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g1</span></a> <span class="o">=</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g2</span></a> <span class="o">=</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Fit power spectrum models</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF.fit" title="fooof.FOOOF.fit" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fm_pa_g1</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">g1_spectrum_pa</span><span class="p">)</span>
<a href="../../generated/fooof.FOOOF.html#fooof.FOOOF.fit" title="fooof.FOOOF.fit" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fm_pa_g2</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">g2_spectrum_pa</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the power spectra differences</span>
<a href="../../generated/fooof.plts.spectra.plot_spectra_shading.html#fooof.plts.spectra.plot_spectra_shading" title="fooof.plts.spectra.plot_spectra_shading" class="sphx-glr-backref-module-fooof-plts-spectra sphx-glr-backref-type-py-function"><span class="n">plot_spectra_shading</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="p">[</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g1</span></a><span class="o">.</span><span class="n">_spectrum_flat</span><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g2</span></a><span class="o">.</span><span class="n">_spectrum_flat</span><span class="p">],</span>
                     <span class="n">log_powers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                     <span class="n">shades</span><span class="o">=</span><a href="../../generated/fooof.Bands.html#fooof.Bands.definitions" title="fooof.Bands.definitions" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">bands</span><span class="o">.</span><span class="n">definitions</span></a><span class="p">,</span> <span class="n">shade_colors</span><span class="o">=</span><span class="n">shade_cols</span><span class="p">,</span>
                     <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">f_range</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Periodic &amp; Aperiodic - Flattened&#39;</span><span class="p">,</span> <span class="n">t_settings</span><span class="p">);</span>
</pre></div>
</div>
<img alt="Periodic &amp; Aperiodic - Flattened" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_BandByBand_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Periodic &amp; Aperiodic - Flattened&#39;)
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>Compare Spectral Parameters<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Let’s again compare the measured parameters of the data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the difference of aperiodic activity between age groups</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">compare_exp</span><span class="p">(</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g1</span></a><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g2</span></a><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The difference of aperiodic exponent is:         0.25
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the difference in periodic activity, across bands, between groups</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">definition</span> <span class="ow">in</span> <a href="../../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pw_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">label</span><span class="p">,</span>
                             <span class="n">compare_peak_pw</span><span class="p">(</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g1</span></a><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g2</span></a><span class="p">,</span> <span class="n">definition</span><span class="p">),</span>
                             <span class="n">compare_band_pw</span><span class="p">(</span><a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g1</span></a><span class="p">,</span> <a href="../../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm_pa_g2</span></a><span class="p">,</span> <span class="n">definition</span><span class="p">)))</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>The difference of delta power is   nan  with peaks or   0.21     with bands.
The difference of theta power is   nan  with peaks or   0.11     with bands.
The difference of alpha power is   0.00 with peaks or   0.05     with bands.
The difference of beta  power is   nan  with peaks or  -0.03     with bands.
The difference of gamma power is   nan  with peaks or  -0.10     with bands.
</pre></div>
</div>
<p>In the measurements above, we can now see that we are measuring a difference in the
aperiodic properties of the data.</p>
<p>We also see a different results when looking at bands / peaks, depending on how we
analyze them. The band-by-band analysis reports a pattern of differences across
the frequency bands. However, the parameterized analysis reports no differences in
identified peaks.</p>
<p>Note that when comparing peaks, ‘nan’ reflects that there were no identified peaks to
compare, where are a zero value reflects that peaks were detected, but they did not differ.</p>
<p>In this case, we know that the parameterization approach results in the correct
interpretation of the changes in the data.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Here we have investigated changes across power spectra, comparing a ‘band-by-band’
approach to the parameterizing neural power spectra notion of ‘periodic &amp; aperiodic’
components.</p>
<p>What we can see is that parameterizing neural power spectra is able to determine
if changes are driven by differences in oscillatory peaks, and/or by changes in the
aperiodic component of the data.</p>
<p>However, we also saw that simply doing a band-by-band power analysis can conflate differences
from aperiodic and periodic changes. Specifically, when we change the aperiodic activity
in a power spectrum, the band-by-band analysis suggests that multiple distinct frequency
bands are changing, whereas the more parsimonious (and in the simulated case, the true)
conclusion should be that changes are driven by changes in the aperiodic activity
that affects all frequencies. This also means that if a band-by-band analysis finds
differences across bands, this is not enough to know if there are band-specific changes,
or aperiodic changes, as this analysis approach does not differentiate the two.</p>
<p>We conclude here that band-by-band analysis, without measuring or controlling for
aperiodic activity, are ill posed to adjudicate which aspects of the data are changing.
Parameterizing neural power spectra allows for disentangling changes in
periodic and aperiodic components of the data.</p>
<p>In this example, with simulated data, we cannot conclude which changes are more likely
to be occurring in real data. However, in the real data analysis that this example
is based on, it was found that a great deal of the changes across development are
driven by aperiodic changes, and not by band-by-band differences. This finding
came from using the parameterization approach, but was not evidence in prior
work using only a band-by-band approach.
You can find more on that project
<a class="reference external" href="https://doi.org/10.1101/839258">here</a>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.476 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-motivations-measurements-plot-bandbyband-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/25a20a64f0f68c43d76a91f17876de66/plot_BandByBand.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_BandByBand.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/b6191b178a287c7db5f8ad9da5406ff5/plot_BandByBand.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_BandByBand.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2020, VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.2.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>