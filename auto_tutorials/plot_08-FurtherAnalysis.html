<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>08: Further Analysis &#8212; fooof 1.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172157729-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172157729-1');
</script>


  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          fooof</a>
        <span class="navbar-text navbar-version pull-left"><b>1.1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../faq.html">FAQ</a></li>
                <li><a href="../glossary.html">Glossary</a></li>
                <li><a href="../auto_motivations/index.html">Motivations</a></li>
                <li><a href="index.html">Tutorials</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../visualizers.html">Visualizers</a></li>
                <li><a href="../reference.html">Reference</a></li>
                <li><a href="https://github.com/fooof-tools/fooof">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-tutorials-plot-08-furtheranalysis-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="further-analysis">
<span id="sphx-glr-auto-tutorials-plot-08-furtheranalysis-py"></span><h1>08: Further Analysis<a class="headerlink" href="#further-analysis" title="Permalink to this heading">¶</a></h1>
<p>Analyze results from fitting power spectrum models.</p>
<section id="exploring-power-spectrum-model-results">
<h2>Exploring Power Spectrum Model Results<a class="headerlink" href="#exploring-power-spectrum-model-results" title="Permalink to this heading">¶</a></h2>
<p>So far we have explored how to parameterize neural power spectra, whereby we can measure
parameters of interest from data - in particular measuring aperiodic and periodic activity.</p>
<p>These measured parameters can then be examined within or between groups of interest,
and/or fed into further analyses. For example, one could examine if these parameters
predict behavioural or physiological features of interest. Largely, it is up to you what
to do after fitting power spectrum models, as it depends on your questions of interest.</p>
<p>Here, we briefly introduce some analysis utilities that are included in the module,
and explore some simple analyses that can be done with model parameters.</p>
<p>To start, we will load and fit some example data, as well as simulate a group of
power spectra to fit with power spectrum models, to use as examples for this tutorial.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># General imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Import the FOOOF and FOOOFGroup objects</span>
<span class="kn">from</span> <span class="nn">fooof</span> <span class="kn">import</span> <a href="../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a><span class="p">,</span> <a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="fooof.FOOOFGroup" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOFGroup</span></a>

<span class="c1"># Import the Bands object, which is used to define frequency bands</span>
<span class="kn">from</span> <span class="nn">fooof.bands</span> <span class="kn">import</span> <a href="../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">Bands</span></a>

<span class="c1"># Import simulation code and utilities</span>
<span class="kn">from</span> <span class="nn">fooof.sim.params</span> <span class="kn">import</span> <a href="../generated/fooof.sim.params.param_sampler.html#fooof.sim.params.param_sampler" title="fooof.sim.params.param_sampler" class="sphx-glr-backref-module-fooof-sim-params sphx-glr-backref-type-py-function"><span class="n">param_sampler</span></a>
<span class="kn">from</span> <span class="nn">fooof.sim.gen</span> <span class="kn">import</span> <a href="../generated/fooof.sim.gen_group_power_spectra.html#fooof.sim.gen_group_power_spectra" title="fooof.sim.gen_group_power_spectra" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_group_power_spectra</span></a>
<span class="kn">from</span> <span class="nn">fooof.sim.utils</span> <span class="kn">import</span> <a href="../generated/fooof.sim.utils.set_random_seed.html#fooof.sim.utils.set_random_seed" title="fooof.sim.utils.set_random_seed" class="sphx-glr-backref-module-fooof-sim-utils sphx-glr-backref-type-py-function"><span class="n">set_random_seed</span></a>

<span class="c1"># Import some analysis functions</span>
<span class="kn">from</span> <span class="nn">fooof.analysis</span> <span class="kn">import</span> <a href="../generated/fooof.analysis.get_band_peak_fm.html#fooof.analysis.get_band_peak_fm" title="fooof.analysis.get_band_peak_fm" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fm</span></a><span class="p">,</span> <a href="../generated/fooof.analysis.get_band_peak_fg.html#fooof.analysis.get_band_peak_fg" title="fooof.analysis.get_band_peak_fg" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fg</span></a>

<span class="c1"># Import a utility to download and load example data</span>
<span class="kn">from</span> <span class="nn">fooof.utils.download</span> <span class="kn">import</span> <span class="n">load_fooof_data</span>
</pre></div>
</div>
<section id="load-and-fit-example-data">
<h3>Load and Fit Example Data<a class="headerlink" href="#load-and-fit-example-data" title="Permalink to this heading">¶</a></h3>
<p>First, let’s load and fit an example power spectrum.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load example data files needed for this example</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">load_fooof_data</span><span class="p">(</span><span class="s1">&#39;freqs.npy&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">load_fooof_data</span><span class="p">(</span><span class="s1">&#39;spectrum.npy&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit a power spectrum model</span>
<a href="../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm</span></a> <span class="o">=</span> <a href="../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOF</span></a><span class="p">(</span><span class="n">peak_width_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<a href="../generated/fooof.FOOOF.html#fooof.FOOOF.fit" title="fooof.FOOOF.fit" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fm</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">spectrum</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="simulate-and-fit-group-data">
<h3>Simulate and Fit Group Data<a class="headerlink" href="#simulate-and-fit-group-data" title="Permalink to this heading">¶</a></h3>
<p>We will also simulate and fit some additional example data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed, for consistency generating simulated data</span>
<a href="../generated/fooof.sim.utils.set_random_seed.html#fooof.sim.utils.set_random_seed" title="fooof.sim.utils.set_random_seed" class="sphx-glr-backref-module-fooof-sim-utils sphx-glr-backref-type-py-function"><span class="n">set_random_seed</span></a><span class="p">(</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Generate some simulated power spectra</span>
<span class="n">freqs</span><span class="p">,</span> <span class="n">spectra</span> <span class="o">=</span> <a href="../generated/fooof.sim.gen_group_power_spectra.html#fooof.sim.gen_group_power_spectra" title="fooof.sim.gen_group_power_spectra" class="sphx-glr-backref-module-fooof-sim sphx-glr-backref-type-py-function"><span class="n">gen_group_power_spectra</span></a><span class="p">(</span><span class="n">n_spectra</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                         <span class="n">freq_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
                                         <span class="n">aperiodic_params</span><span class="o">=</span><a href="../generated/fooof.sim.params.param_sampler.html#fooof.sim.params.param_sampler" title="fooof.sim.params.param_sampler" class="sphx-glr-backref-module-fooof-sim-params sphx-glr-backref-type-py-function"><span class="n">param_sampler</span></a><span class="p">([[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]]),</span>
                                         <span class="n">periodic_params</span><span class="o">=</span><a href="../generated/fooof.sim.params.param_sampler.html#fooof.sim.params.param_sampler" title="fooof.sim.params.param_sampler" class="sphx-glr-backref-module-fooof-sim-params sphx-glr-backref-type-py-function"><span class="n">param_sampler</span></a><span class="p">([[],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize a FOOOFGroup object with some settings</span>
<a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="fooof.FOOOFGroup" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fg</span></a> <span class="o">=</span> <a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="fooof.FOOOFGroup" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">FOOOFGroup</span></a><span class="p">(</span><span class="n">peak_width_limits</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">min_peak_height</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                <span class="n">max_n_peaks</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Fit power spectrum models across the group of simulated power spectra</span>
<a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup.fit" title="fooof.FOOOFGroup.fit" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fg</span><span class="o">.</span><span class="n">fit</span></a><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">spectra</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="analysis-utilities">
<h2>Analysis Utilities<a class="headerlink" href="#analysis-utilities" title="Permalink to this heading">¶</a></h2>
<p>The FOOOF module includes some analysis functions.</p>
<p>Note that these utilities are generally relatively simple utilities that assist in
accessing and investigating the model parameters.</p>
<p>In depth analysis of power spectrum model results is typically idiosyncratic to the goals of
the project, and so we consider that this will typically require custom code. Here, we seek
to offer the most useful general utilities.</p>
<p>We will demonstrate some of these utility functions covering some general use cases.</p>
</section>
<section id="analyzing-periodic-components">
<h2>Analyzing Periodic Components<a class="headerlink" href="#analyzing-periodic-components" title="Permalink to this heading">¶</a></h2>
<p>We will start by analyzing the periodic components.</p>
<p>These utilities mostly serve to help organize and extract periodic components,
for example extracting peaks that fall within defined frequency bands.</p>
<p>This also includes the <a class="reference internal" href="../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bands</span></code></a> object, which is a custom, dictionary-like object,
that is provided to store frequency band definitions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define frequency bands of interest</span>
<a href="../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a> <span class="o">=</span> <a href="../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class"><span class="n">Bands</span></a><span class="p">({</span><span class="s1">&#39;theta&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
               <span class="s1">&#39;alpha&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
               <span class="s1">&#39;beta&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">]})</span>
</pre></div>
</div>
<section id="extracting-peaks-from-fooof-objects">
<h3>Extracting peaks from FOOOF Objects<a class="headerlink" href="#extracting-peaks-from-fooof-objects" title="Permalink to this heading">¶</a></h3>
<p>The <a class="reference internal" href="../generated/fooof.analysis.get_band_peak_fm.html#fooof.analysis.get_band_peak_fm" title="fooof.analysis.get_band_peak_fm"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_band_peak_fm()</span></code></a> function takes in a
<a class="reference internal" href="../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF"><code class="xref py py-class docutils literal notranslate"><span class="pre">FOOOF</span></code></a> object and extracts peak(s) from a requested frequency range.</p>
<p>You can optionally specify:</p>
<ul class="simple">
<li><p>whether to return one peak from the specified band, in which case the highest peak is
returned, or whether to return all peaks from within the band</p></li>
<li><p>whether to apply a minimum threshold to extract peaks, for example, to extract
peaks only above some minimum power threshold</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract any alpha band peaks from the power spectrum model</span>
<span class="n">alpha</span> <span class="o">=</span> <a href="../generated/fooof.analysis.get_band_peak_fm.html#fooof.analysis.get_band_peak_fm" title="fooof.analysis.get_band_peak_fm" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fm</span></a><span class="p">(</span><a href="../generated/fooof.FOOOF.html#fooof.FOOOF" title="fooof.FOOOF" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fm</span></a><span class="p">,</span> <a href="../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[9.48376672 0.91782115 2.        ]
</pre></div>
</div>
</section>
<section id="extracting-peaks-from-fooofgroup-objects">
<h3>Extracting peaks from FOOOFGroup Objects<a class="headerlink" href="#extracting-peaks-from-fooofgroup-objects" title="Permalink to this heading">¶</a></h3>
<p>Similarly, the <a class="reference internal" href="../generated/fooof.analysis.get_band_peak_fg.html#fooof.analysis.get_band_peak_fg" title="fooof.analysis.get_band_peak_fg"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_band_peak_fg()</span></code></a> function can be used
to select peaks from specified frequency ranges, from <a class="reference internal" href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="fooof.FOOOFGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FOOOFGroup</span></code></a> objects.</p>
<p>Note that you can also apply a threshold to extract group peaks but, as discussed below,
this approach will always only extract at most one peak per individual model fit from
the FOOOFGroup object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get all alpha peaks from a group of power spectrum models</span>
<span class="n">alphas</span> <span class="o">=</span> <a href="../generated/fooof.analysis.get_band_peak_fg.html#fooof.analysis.get_band_peak_fg" title="fooof.analysis.get_band_peak_fg" class="sphx-glr-backref-module-fooof-analysis sphx-glr-backref-type-py-function"><span class="n">get_band_peak_fg</span></a><span class="p">(</span><a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup" title="fooof.FOOOFGroup" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fg</span></a><span class="p">,</span> <a href="../generated/fooof.Bands.html#fooof.Bands" title="fooof.Bands" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bands</span></a><span class="o">.</span><span class="n">alpha</span><span class="p">)</span>

<span class="c1"># Check out some of the alpha parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alphas</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[10.03970097  0.48627814  3.78823186]
 [10.03394843  0.48807386  3.82620803]
 [        nan         nan         nan]
 [10.04095697  0.49087309  3.81808357]
 [        nan         nan         nan]]
</pre></div>
</div>
<p>When selecting peaks from a group of model fits, we want to retain information about
which model each peak comes from.</p>
<p>To do so, the output of <a class="reference internal" href="../generated/fooof.analysis.get_band_peak_fg.html#fooof.analysis.get_band_peak_fg" title="fooof.analysis.get_band_peak_fg"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_band_peak_fg()</span></code></a> is organized such that each row
corresponds to a specific model fit. This means that returned array has the shape
[n_models, 3], and so the index of each row corresponds to the index of the model
from the FOOOFGroup object.</p>
<p>For this to work, at most 1 peak is extracted for each model fit within the specified band.
If more than 1 peak are found within the band, the peak with the highest power is extracted.
If no peaks are found, that row is filled with ‘nan’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check descriptive statistics of extracted peak parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha CF : </span><span class="si">{:1.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">alphas</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha PW : </span><span class="si">{:1.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">alphas</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Alpha BW : </span><span class="si">{:1.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">alphas</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Alpha CF : 10.03
Alpha PW : 0.49
Alpha BW : 3.81
</pre></div>
</div>
</section>
<section id="customizing-peak-extraction">
<h3>Customizing Peak Extraction<a class="headerlink" href="#customizing-peak-extraction" title="Permalink to this heading">¶</a></h3>
<p>If you want to do more customized extraction of peaks, for example, extracting all peaks
in a frequency band from each model in a FOOOFGroup object, you may need to use the
underlying functions that operate on arrays of peak parameters. To explore these functions,
check the listings in the API page.</p>
</section>
</section>
<section id="a-note-on-frequency-ranges">
<h2>A Note on Frequency Ranges<a class="headerlink" href="#a-note-on-frequency-ranges" title="Permalink to this heading">¶</a></h2>
<p>A benefit of fitting power spectrum models is that you do not have to define
a priori frequency ranges from which to extract peaks.</p>
<p>Nevertheless, it may still be useful to group extracted peaks into ‘bands’ of interest,
which is why the aforementioned functions are offered.</p>
<p>Since this frequency-range selection can be done after model fitting, we do recommend
checking the model results, for example by checking a histogram of the center frequencies
extracted across a group, in order to ensure the frequency ranges you choose reflect
the characteristics of the data under study.</p>
</section>
<section id="analyzing-the-aperiodic-component">
<h2>Analyzing the Aperiodic Component<a class="headerlink" href="#analyzing-the-aperiodic-component" title="Permalink to this heading">¶</a></h2>
<p>Typically, for analyzing the aperiodic component of the data, aperiodic parameters
just need to be extracted from FOOOF objects and fit into analyses of interest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot from the FOOOFGroup, to visualize the parameters</span>
<a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup.plot" title="fooof.FOOOFGroup.plot" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fg</span><span class="o">.</span><span class="n">plot</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_plot_08-FurtherAnalysis_001.png" srcset="../_images/sphx_glr_plot_08-FurtherAnalysis_001.png" alt="Aperiodic Fit, Goodness of Fit, Peaks - Center Frequencies" class = "sphx-glr-single-img"/><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract aperiodic exponent parameters from group results</span>
<span class="n">exps</span> <span class="o">=</span> <a href="../generated/fooof.FOOOFGroup.html#fooof.FOOOFGroup.get_params" title="fooof.FOOOFGroup.get_params" class="sphx-glr-backref-module-fooof sphx-glr-backref-type-py-method"><span class="n">fg</span><span class="o">.</span><span class="n">get_params</span></a><span class="p">(</span><span class="s1">&#39;aperiodic_params&#39;</span><span class="p">,</span> <span class="s1">&#39;exponent&#39;</span><span class="p">)</span>

<span class="c1"># Check out the aperiodic exponent results</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exps</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[1.5174828  1.51806721 1.99827884 1.5156351  2.00559925 2.01700246
 2.00089211 2.02010985 1.51575182 1.99955831]
</pre></div>
</div>
</section>
<section id="example-analyses">
<h2>Example Analyses<a class="headerlink" href="#example-analyses" title="Permalink to this heading">¶</a></h2>
<p>Once you have extracted parameters of interest, you can analyze them by, for example:</p>
<ul class="simple">
<li><p>Characterizing periodic &amp; aperiodic properties,
and analyzing spatial topographies, across demographics, modalities, and tasks</p></li>
<li><p>Comparing peaks within and between subjects across different tasks of interest</p></li>
<li><p>Predicting disease state based on power spectrum model parameters</p></li>
<li><p>Fitting power spectrum models in a trial-by-trial approach to try and decode task
properties, and behavioral states</p></li>
</ul>
<p>So far we have only introduced the basic utilities to help with selecting and
examining power spectrum model parameters.</p>
<p>To further explore some of these specific analyses, and explore other
utilities that may be useful, check out the
<a class="reference external" href="https://fooof-tools.github.io/fooof/auto_examples/index.html">examples</a>
page.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">¶</a></h2>
<p>This is the end of the main tutorial materials!</p>
<p>If you are having any troubles, please submit an issue on Github
<a class="reference external" href="https://github.com/fooof-tools/fooof">here</a>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.279 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-tutorials-plot-08-furtheranalysis-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/bf02a0d9260abd47504beac02e8ba2e3/plot_08-FurtherAnalysis.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_08-FurtherAnalysis.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5ee90e99e6d971d885ad278c3972711e/plot_08-FurtherAnalysis.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_08-FurtherAnalysis.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2023, VoytekLab.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>